<!-- Not found state -->
<div *if="!hasData" class="min-h-screen flex items-center justify-center">
  <div class="text-center">
    <h1 class="text-2xl font-bold text-stone-100 mb-4">Contract Not Found</h1>
    <p class="text-stone-400 mb-8">The contract you're looking for doesn't exist or has been removed.</p>
    <a
      [href]="backHref"
      class="px-6 py-3 bg-amber-600 hover:bg-amber-500 text-white font-semibold rounded-xl transition-colors"
    >
      Back to Contracts
    </a>
  </div>
</div>

<!-- Contract signing page -->
<div *if="hasData" class="min-h-screen">
  <!-- Background Effects -->
  <div class="fixed inset-0 overflow-hidden pointer-events-none">
    <div class="absolute top-0 left-1/4 w-[500px] h-[500px] bg-amber-500/10 rounded-full blur-[128px]"></div>
    <div class="absolute bottom-0 right-1/4 w-[400px] h-[400px] bg-blue-500/10 rounded-full blur-[128px]"></div>
  </div>

  <div class="relative max-w-4xl mx-auto px-6 py-12 space-y-8">
    <!-- Header -->
    <div class="flex items-center justify-between">
      <div>
        <a
          [href]="contractDetailHref"
          class="text-sm text-stone-500 hover:text-stone-300 transition-colors flex items-center gap-1 mb-2"
        >
          <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
          </svg>
          Back to Contract
        </a>
        <h1 class="text-2xl font-bold text-stone-100">Contract Agreement</h1>
        <p class="text-stone-400 mt-1">{{ quoteSummary }}</p>
      </div>
      <div *if="isSigned" class="flex items-center gap-2 px-4 py-2 bg-green-900/30 border border-green-700/50 rounded-xl">
        <svg class="w-5 h-5 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
        </svg>
        <span class="text-sm font-medium text-green-400">Signed & Locked</span>
      </div>
    </div>

    <!-- Contract Document -->
    <div class="relative">
      <div class="absolute inset-0 bg-gradient-to-b from-amber-500/5 via-transparent to-transparent rounded-3xl"></div>
      <div class="relative glass-card p-8 space-y-8">
        <!-- Parties -->
        <div class="grid md:grid-cols-2 gap-6">
          <div class="p-5 bg-stone-800/40 rounded-xl border border-stone-700/30">
            <div class="text-xs font-semibold text-amber-500 uppercase tracking-wider mb-3">Contractor</div>
            <div class="text-lg font-semibold text-stone-100">{{ contractorName }}</div>
            <div class="text-sm text-stone-400 mt-1">{{ contractorEmail }}</div>
            <div class="text-sm text-stone-500">{{ contractorPhone }}</div>
          </div>
          <div class="p-5 bg-stone-800/40 rounded-xl border border-stone-700/30">
            <div class="text-xs font-semibold text-blue-400 uppercase tracking-wider mb-3">Customer</div>
            <div class="text-lg font-semibold text-stone-100">{{ customerName }}</div>
            <div class="text-sm text-stone-400 mt-1">{{ customerEmail }}</div>
            <div class="text-sm text-stone-500">{{ customerPhone }}</div>
          </div>
        </div>

        <!-- Scope of Work -->
        <div>
          <h3 class="text-lg font-semibold text-stone-100 mb-4 flex items-center gap-2">
            <svg class="w-5 h-5 text-amber-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
            </svg>
            Scope of Work
          </h3>
          <div class="overflow-hidden rounded-xl border border-stone-700/40">
            <table class="w-full text-sm">
              <thead class="bg-stone-800/60">
                <tr>
                  <th class="text-left px-5 py-3 text-xs font-semibold text-stone-400 uppercase">Description</th>
                  <th class="text-right px-5 py-3 text-xs font-semibold text-stone-400 uppercase">Qty</th>
                  <th class="text-right px-5 py-3 text-xs font-semibold text-stone-400 uppercase">Unit</th>
                  <th class="text-right px-5 py-3 text-xs font-semibold text-stone-400 uppercase">Price</th>
                  <th class="text-right px-5 py-3 text-xs font-semibold text-stone-400 uppercase">Total</th>
                </tr>
              </thead>
              <tbody>
                <tr *for="let item of lineItems" class="border-t border-stone-700/30">
                  <td class="px-5 py-4 text-stone-200">{{ item.description }}</td>
                  <td class="px-5 py-4 text-right text-stone-400">{{ item.quantity }}</td>
                  <td class="px-5 py-4 text-right text-stone-400">{{ item.unit }}</td>
                  <td class="px-5 py-4 text-right text-stone-400">{{ formatCurrency(item.price) }}</td>
                  <td class="px-5 py-4 text-right text-stone-200 font-medium">{{ getLineTotal(item) }}</td>
                </tr>
              </tbody>
              <tfoot class="bg-stone-800/40">
                <tr>
                  <td colspan="4" class="px-5 py-4 text-right text-sm font-semibold text-stone-300">Total Contract Value</td>
                  <td class="px-5 py-4 text-right">
                    <span class="text-xl font-bold text-amber-400">{{ formatCurrency(estimatedTotal) }}</span>
                  </td>
                </tr>
              </tfoot>
            </table>
          </div>
        </div>

        <!-- Timeline -->
        <div *if="hasTimeline" class="flex items-center gap-3 p-4 bg-stone-800/40 rounded-xl border border-stone-700/30">
          <div class="w-10 h-10 rounded-lg bg-amber-500/10 flex items-center justify-center">
            <svg class="w-5 h-5 text-amber-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
          <div>
            <div class="text-xs font-semibold text-stone-500 uppercase">Estimated Timeline</div>
            <div class="text-stone-200 font-medium">{{ timeline }}</div>
          </div>
        </div>

        <!-- Terms -->
        <div class="p-5 bg-stone-800/30 rounded-xl border border-stone-700/30 text-sm text-stone-400 space-y-3">
          <h4 class="text-stone-300 font-medium">Terms & Conditions</h4>
          <p>By signing below, you agree to the scope of work and pricing outlined above. Payment terms are net 30 unless otherwise specified. Any changes to the scope must be agreed upon in writing.</p>
          <p>This agreement shall be binding upon execution by both parties.</p>
        </div>

        <!-- Signature Section -->
        <div class="pt-6 border-t border-stone-700/50">
          <h3 class="text-lg font-semibold text-stone-100 mb-4 flex items-center gap-2">
            <svg class="w-5 h-5 text-amber-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
            </svg>
            Customer Signature
          </h3>
          <ContractSigner
            [contractId]="contractId"
            [existingSignature]="existingSignature"
            [isSigned]="isSigned"
            [apiBaseUrl]="apiBaseUrl"
            [isDemo]="isDemo"
          />
        </div>
      </div>
    </div>
  </div>
</div>
<Toast />
